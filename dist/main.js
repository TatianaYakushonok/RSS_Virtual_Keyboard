(()=>{"use strict";function t(t,l){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var l=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=l){var s,i,a=[],o=!0,n=!1;try{for(l=l.call(t);!(o=(s=l.next()).done)&&(a.push(s.value),!e||a.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{o||null==l.return||l.return()}finally{if(n)throw i}}return a}}(t,l)||function(t,l){if(t){if("string"==typeof t)return e(t,l);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?e(t,l):void 0}}(t,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var l=0,s=new Array(e);l<e;l++)s[l]=t[l];return s}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(e,s,i,a){var o=null;try{o=document.createElement(e)}catch(t){throw new Error("Unable to create HTMLElement! Give a proper tag name")}s&&o.classList.add(s.split(" ")),i&&Array.isArray(i)?i.forEach((function(t){return t&&o.appendChild(t)})):i&&"object"===l(i)?o.appendChild(i):i&&"string"==typeof i&&(o.innerHTML=i),a&&a.appendChild(o);for(var n=arguments.length,c=new Array(n>4?n-4:0),r=4;r<n;r++)c[r-4]=arguments[r];return c.length&&c.forEach((function(e){var l=t(e,2),s=l[0],i=l[1];""===i&&o.setAttribute(s,""),s.match(/value|id|placeholder|cols|rows|autocorrect|spellcheck/)?o.setAttribute(s,i):o.dataset[s]=i})),o}const i={ru:[{small:"ё",shift:"Ё",code:"Backquote"},{small:"1",shift:"!",code:"Digit1"},{small:"2",shift:'"',code:"Digit2"},{small:"3",shift:"№",code:"Digit3"},{small:"4",shift:";",code:"Digit4"},{small:"5",shift:"%",code:"Digit5"},{small:"6",shift:":",code:"Digit6"},{small:"7",shift:"?",code:"Digit7"},{small:"8",shift:"*",code:"Digit8"},{small:"9",shift:"(",code:"Digit9"},{small:"0",shift:")",code:"Digit0"},{small:"-",shift:"_",code:"Minus"},{small:"=",shift:"+",code:"Equal"},{small:"Back",shift:null,code:"Backspace"},{small:"Tab",shift:null,code:"Tab"},{small:"й",shift:"Й",code:"KeyQ"},{small:"ц",shift:"Ц",code:"KeyW"},{small:"у",shift:"У",code:"KeyE"},{small:"к",shift:"К",code:"KeyR"},{small:"е",shift:"Е",code:"KeyT"},{small:"н",shift:"Н",code:"KeyY"},{small:"г",shift:"Г",code:"KeyU"},{small:"ш",shift:"Ш",code:"KeyI"},{small:"щ",shift:"Щ",code:"KeyO"},{small:"з",shift:"З",code:"KeyP"},{small:"х",shift:"Х",code:"BracketLeft"},{small:"ъ",shift:"Ъ",code:"BracketRight"},{small:"&bsol;",shift:null,code:"Backslash"},{small:"Del",shift:null,code:"Delete"},{small:"CapsLock",shift:null,code:"CapsLock"},{small:"ф",shift:"Ф",code:"KeyA"},{small:"ы",shift:"Ы",code:"KeyS"},{small:"в",shift:"В",code:"KeyD"},{small:"а",shift:"А",code:"KeyF"},{small:"п",shift:"П",code:"KeyG"},{small:"р",shift:"Р",code:"KeyH"},{small:"о",shift:"О",code:"KeyJ"},{small:"л",shift:"Л",code:"KeyK"},{small:"д",shift:"Д",code:"KeyL"},{small:"ж",shift:"Ж",code:"Semicolon"},{small:"э",shift:"Э",code:"Quote"},{small:"Enter",shift:null,code:"Enter"},{small:"Shift",shift:null,code:"ShiftLeft"},{small:"я",shift:"Я",code:"KeyZ"},{small:"ч",shift:"Ч",code:"KeyX"},{small:"с",shift:"С",code:"KeyC"},{small:"м",shift:"М",code:"KeyV"},{small:"и",shift:"И",code:"KeyB"},{small:"т",shift:"Т",code:"KeyN"},{small:"ь",shift:"Ь",code:"KeyM"},{small:"б",shift:"Б",code:"Comma"},{small:"ю",shift:"Ю",code:"Period"},{small:".",shift:null,code:"Slash"},{small:"&uarr;",shift:null,code:"ArrowUp"},{small:"Shift",shift:null,code:"ShiftRight"},{small:"Ctrl",shift:null,code:"ControlLeft"},{small:"Win",shift:null,code:"MetaLeft"},{small:"Alt",shift:null,code:"AltLeft"},{small:" ",shift:null,code:"Space"},{small:"Alt",shift:null,code:"AltRight"},{small:"Ctrl",shift:null,code:"ControlRight"},{small:"&larr;",shift:null,code:"ArrowLeft"},{small:"&darr;",shift:null,code:"ArrowDown"},{small:"&rarr;",shift:null,code:"ArrowRight"}],en:[{small:"`",shift:"~",code:"Backquote"},{small:"1",shift:"!",code:"Digit1"},{small:"2",shift:"@",code:"Digit2"},{small:"3",shift:"#",code:"Digit3"},{small:"4",shift:"$",code:"Digit4"},{small:"5",shift:"%",code:"Digit5"},{small:"6",shift:"^",code:"Digit6"},{small:"7",shift:"&",code:"Digit7"},{small:"8",shift:"*",code:"Digit8"},{small:"9",shift:"(",code:"Digit9"},{small:"0",shift:")",code:"Digit0"},{small:"-",shift:"_",code:"Minus"},{small:"=",shift:"+",code:"Equal"},{small:"Back",shift:null,code:"Backspace"},{small:"Tab",shift:null,code:"Tab"},{small:"q",shift:"Q",code:"KeyQ"},{small:"w",shift:"W",code:"KeyW"},{small:"e",shift:"E",code:"KeyE"},{small:"r",shift:"R",code:"KeyR"},{small:"t",shift:"T",code:"KeyT"},{small:"y",shift:"Y",code:"KeyY"},{small:"u",shift:"U",code:"KeyU"},{small:"i",shift:"I",code:"KeyI"},{small:"o",shift:"O",code:"KeyO"},{small:"p",shift:"P",code:"KeyP"},{small:"[",shift:"{",code:"BracketLeft"},{small:"]",shift:"}",code:"BracketRight"},{small:"&bsol;",shift:"|",code:"Backslash"},{small:"Del",shift:null,code:"Delete"},{small:"CapsLock",shift:null,code:"CapsLock"},{small:"a",shift:"A",code:"KeyA"},{small:"s",shift:"S",code:"KeyS"},{small:"d",shift:"D",code:"KeyD"},{small:"f",shift:"F",code:"KeyF"},{small:"g",shift:"G",code:"KeyG"},{small:"h",shift:"H",code:"KeyH"},{small:"j",shift:"J",code:"KeyJ"},{small:"k",shift:"K",code:"KeyK"},{small:"l",shift:"L",code:"KeyL"},{small:";",shift:":",code:"Semicolon"},{small:"'",shift:'"',code:"Quote"},{small:"Enter",shift:null,code:"Enter"},{small:"Shift",shift:null,code:"ShiftLeft"},{small:"z",shift:"Z",code:"KeyZ"},{small:"x",shift:"X",code:"KeyX"},{small:"c",shift:"C",code:"KeyC"},{small:"v",shift:"V",code:"KeyV"},{small:"b",shift:"B",code:"KeyB"},{small:"n",shift:"N",code:"KeyN"},{small:"m",shift:"M",code:"KeyM"},{small:",",shift:"<",code:"Comma"},{small:".",shift:">",code:"Period"},{small:"&sol;",shift:"?",code:"Slash"},{small:"&uarr;",shift:null,code:"ArrowUp"},{small:"Shift",shift:null,code:"ShiftRight"},{small:"Ctrl",shift:null,code:"ControlLeft"},{small:"Win",shift:null,code:"MetaLeft"},{small:"Alt",shift:null,code:"AltLeft"},{small:" ",shift:null,code:"Space"},{small:"Alt",shift:null,code:"AltRight"},{small:"Ctrl",shift:null,code:"ControlRight"},{small:"&larr;",shift:null,code:"ArrowLeft"},{small:"&darr;",shift:null,code:"ArrowDown"},{small:"&rarr;",shift:null,code:"ArrowRight"}]};function a(t,e){for(var l=0;l<e.length;l++){var s=e[l];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function o(t,e,l){return e&&a(t.prototype,e),l&&a(t,l),Object.defineProperty(t,"prototype",{writable:!1}),t}var n=o((function t(e){var l=e.small,i=e.shift,a=e.code;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code=a,this.small=l,this.shift=i,this.isFnKey=Boolean(l.match(/Ctrl|arr|Shift|Alt|Tab|Back|Del|Enter|Win|CapsLock/)),i&&i.match(/[^a-zA-Zа-яА-ЯёЁ0-9]/)?this.sub=s("div","sub",this.shift):this.sub=s("div","sub",""),this.letter=s("div","letter",l),this.div=s("div","keyboard__key",[this.sub,this.letter],null,["code",this.code]),this.isFnKey}));function c(t,e){for(var l=0;l<e.length;l++){var s=e[l];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,e,l){return e in t?Object.defineProperty(t,e,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[e]=l,t}var h=s("main","main__container",[s("h1","title","RSS Virtual Keyboard"),s("h3","subtitle","Windows keyboard")]),f=function(){function t(e){var l=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"preHandleEvent",(function(t){t.stopPropagation();var e=t.target.closest(".keyboard__key");if(e){var s=e.dataset.code;e.addEventListener("mouseleave",l.resetButtonState),l.handleEvent({code:s,type:t.type})}})),r(this,"resetButtonState",(function(t){var e=t.target.dataset.code,s=l.keyButtons.find((function(t){return t.code===e}));s.div.classList.remove("active"),s.div.removeEventListener("mouseleave",l.resetButtonState)})),r(this,"handleEvent",(function(t){t.stopPropagation&&t.stopPropagation();var e=t.code,s=t.type,i=l.keyButtons.find((function(t){return t.code===e}));i&&(l.output.focus(),s.match(/keydown|mousedown/)?(s.match(/key/)&&t.preventDefault(),e.match(/Shift/)&&(l.shiftKey=!0),l.shiftKey&&l.switchUpperCase(!0),i.div.classList.add("active"),e.match(/CapsLock/)&&!l.isCaps?(l.isCaps=!0,l.switchUpperCase(!0)):e.match(/CapsLock/)&&l.isCaps&&(l.isCaps=!1,l.switchUpperCase(!1),i.div.classList.remove("active")),e.match(/Control/)&&(l.ctrlKey=!0),e.match(/Alt/)&&(l.altKey=!0),e.match(/Control/)&&l.altKey&&l.switchLanguage(),e.match(/Alt/)&&l.ctrlKey&&l.switchLanguage(),l.isCaps?l.isCaps&&(l.shiftKey?l.printToOutput(i,i.sub.innerHTML?i.shift:i.small):l.printToOutput(i,i.sub.innerHTML?i.small:i.shift)):l.printToOutput(i,l.shiftKey?i.shift:i.small)):s.match(/keyup|mouseup/)&&(e.match(/Shift/)&&(l.shiftKey=!1,l.switchUpperCase(!1)),e.match(/Control/)&&(l.ctrlKey=!1),e.match(/Alt/)&&(l.altKey=!1),e.match(/CapsLock/)||i.div.classList.remove("active")))})),r(this,"switchLanguage",(function(){var t,e=Object.keys(i),s=e.indexOf(l.container.dataset.language);l.keyBase=s+1<e.length?i[e[s+=1]]:i[e[s-=s]],l.container.dataset.language=e[s],t=e[s],window.localStorage.setItem("kbLang",JSON.stringify(t)),l.keyButtons.forEach((function(t){var e=l.keyBase.find((function(e){return e.code===t.code}));e&&(t.shift=e.shift,t.small=e.small,e.shift&&e.shift.match(/[^a-zA-Zа-яА-ЯёЁ0-9]/)?t.sub.innerHTML=e.shift:t.sub.innerHTML="",t.letter.innerHTML=e.small)})),l.isCaps&&l.switchUpperCase(!0)})),this.rowsOrder=e,this.keyPressed={},this.isCaps=!1}var e,l;return e=t,(l=[{key:"init",value:function(t){return this.keyBase=i[t],this.output=s("textarea","output",null,h,["placeholder","Start typing text..."],["rows",8],["cols",112],["spellcheck",!1],["autocorrect","off"]),this.paragraf=s("p","paragraf","Use left <kbd>Ctrl</kbd> + <kbd>Alt</kbd> to switch language.",h),this.container=s("div","keyboard",null,h,["language",t]),document.body.prepend(h),this}},{key:"generateLayout",value:function(){var t=this;this.keyButtons=[],this.rowsOrder.forEach((function(e,l){var i=s("div","keyboard__row",null,t.container,["row",l+1]);i.style.gridTemplateColumns="repeat(".concat(e.length,", 1fr)"),e.forEach((function(e){var l=t.keyBase.find((function(t){return t.code===e}));if(l){var s=new n(l);t.keyButtons.push(s),i.appendChild(s.div)}}))})),document.addEventListener("keydown",this.handleEvent),document.addEventListener("keyup",this.handleEvent),this.container.onmousedown=this.preHandleEvent,this.container.onmouseup=this.preHandleEvent}},{key:"switchUpperCase",value:function(t){var e=this;t?this.keyButtons.forEach((function(t){t.sub&&e.shiftKey&&(t.sub.classList.add("sub-active"),t.letter.classList.add("sub-inactive")),t.isFnKey||!e.isCaps||e.shiftKey||t.sub.innerHTML?!t.isFnKey&&e.isCaps&&e.shiftKey?t.letter.innerHTML=t.small:t.isFnKey||t.sub.innerHTML||(t.letter.innerHTML=t.shift):t.letter.innerHTML=t.shift})):this.keyButtons.forEach((function(t){t.sub.innerHTML&&!t.isFnKey?(t.sub.classList.remove("sub-active"),t.letter.classList.remove("sub-inactive"),e.isCaps?e.isCaps&&(t.letter.innerHTML=t.shift):t.letter.innerHTML=t.small):t.isFnKey||(e.isCaps?t.letter.innerHTML=t.shift:t.letter.innerHTML=t.small)}))}},{key:"printToOutput",value:function(t,e){var l=this,s=this.output.selectionStart,i=this.output.value.slice(0,s),a=this.output.value.slice(s),o={Tab:function(){l.output.value="".concat(i,"\t").concat(a),s+=1},ArrowLeft:function(){s=s-1>=0?s-1:0},ArrowRight:function(){s+=1},ArrowUp:function(){var t=l.output.value.slice(0,s).match(/(\n).*${(?!\1)/g)||[[1]];s-=t[0].length},ArrowDown:function(){var t=l.output.value.slice(s).match(/^.*(\n).*(?!\1)/)||[[1]];s+=t[0].length},Enter:function(){l.output.value="".concat(i,"\n").concat(a),s+=1},Delete:function(){l.output.value="".concat(i).concat(a.slice(1))},Backspace:function(){l.output.value="".concat(i.slice(0,-1)).concat(a),s-=1},Space:function(){l.output.value="".concat(i," ").concat(a),s+=1}};o[t.code]?o[t.code]():t.isFnKey||(s+=1,this.output.value="".concat(i).concat(e||"").concat(a)),this.output.setSelectionRange(s,s)}}])&&c(e.prototype,l),Object.defineProperty(e,"prototype",{writable:!1}),t}(),u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return JSON.parse(window.localStorage.getItem(t)||e)}("kbLang",'"ru"');new f([["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","Backslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight"],["ControlLeft","MetaLeft","AltLeft","Space","AltRight","ControlRight","ArrowLeft","ArrowDown","ArrowRight"]]).init(u).generateLayout()})();